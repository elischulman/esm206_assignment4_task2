---
title: "Juvenile Snowshoe Hares - Bonanza Creek"
author: "Eli Schulman"
date: "11/3/2021"
output: html_document
---

***Introduction: ***

***Data and Analysis: *** 

***Data Citation: *** Kielland, K., F.S. Chapin, R.W. Ruess, and Bonanza Creek LTER. 2017. Snowshoe hare physical data in Bonanza Creek Experimental Forest: 1999-Present ver 22. Environmental Data Initiative. https://doi.org/10.6073/pasta/03dce4856d79b91557d8e6ce2cbcdc14

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)

library(tidyverse)
library(here)
library(janitor)
library(lubridate)
```


```{r}
bonanza_hares <- read_csv(here("data", "bonanza_hares.csv")) %>% 
  clean_names() %>% 
# filter for just juvenile hares
  filter(age %in% c("j", "J")) %>% 
  mutate(date = mdy(date)) %>% 
  mutate(year = year(date))
```

### Annual Juvenile Hare Trap Coounts

```{r}
hare_traps <- bonanza_hares %>% 
  group_by(year) %>% 
  summarize(hares_trapped = n())

ggplot(hare_traps, aes(x = year, y = hares_trapped)) +
  geom_bar(stat = "identity", 
           fill = "burlywood4",
           width = .5) +
  scale_x_discrete(limit = c(1999:2012)) +
  theme_minimal() +
  labs (title = "Hares Trapped at Bonanza Creek",
        y = "# of Hares",
        x = "Year",
        caption = "Juvenile Snowshoe Hares trapped at the Bonanza Creek Expirimental Forest") +
  theme(plot.title = element_text(hjust = .5)) 

traps_trends <- hare_traps %>%
  summarize(mean = round(mean(hares_trapped),0),
            max = max(hares_trapped),
            min = min(hares_trapped),
            standard_deviation = sd(hares_trapped))
```
Trapped Snowshoes Takeaway: There is a sampled decline in Juvenile Snowshoe Hares at the Bonanza Creek between 1999 and 2012. However, there are also gaps in the data where no trapped hares were observed (2002, 2009). This indicates that sampling techniques may have lacked in those years, and more generally, could be waning over time. This would be consistent with the observed decline in hare trappings over the years. That being said, the average count of juvenile hares was 32 per year, with a max count of 126 in 1999. This might reflect a relatively high level of interest in the sampling at the onset of the project. 

### Hare Weights by Sex and Site

```{r}
# Create simple df with just weight, sex, and grid (site) values for each observation
hare_weight <- bonanza_hares %>% 
  select(grid, sex, weight) %>% 
  mutate(sex = case_when(
    sex == "f" ~ "Female",
    sex == "m" ~ "Male",
    TRUE ~ "NA"
  ))

# Summarize averages and min/max of weight by sex and grid
weight_avg <- hare_weight %>% 
  group_by(grid, sex) %>% 
  summarize(observations = n(),
            mean_weight = mean(weight, na.rm = TRUE),
            min_weight = min(weight, na.rm = TRUE),
            max_weight = max(weight, na.rm = TRUE))

# Create visualization to show spread of weights by sex and grid
ggplot(hare_weight, aes(x = weight)) +
  geom_histogram(aes(fill = sex),
                 bins = 10,
                 color = "black",
                 alpha = .8) +
  labs(title = "Juvenile Hare Weight Distribution by Site",
       x = "Weight (g)",
       y = "# of Hares",
       fill = "Sex",
       caption = "Figure 2") +
  theme(plot.title = element_text(hjust = .5)) +
  scale_fill_manual(values = c("deeppink3","dodgerblue","grey")) +
  facet_wrap(~ grid) 
```

Fig-2 Caption: Mean Juvenile Snowshoe Hare weights for females at bonbs, bonmat, and bonrip are `r round(weight_avg$mean_weight[1],0)`(g), `r round(weight_avg$mean_weight[4],0)`(g), and `r round(weight_avg$mean_weight[7],0)`(g), respectively. The mean weight for male hares are `r round(weight_avg$mean_weight[2],0)`(g), `r round(weight_avg$mean_weight[5],0)`(g), and `r round(weight_avg$mean_weight[8],0)`(g), respectively. 

### Juvenile Weight Comparison

#### Create lists of weights for males and females
```{r}
# Create a vector for female weights, remove NAs
hare_weight_f <- hare_weight %>% 
  filter(sex == "Female", weight != "NA") %>% 
  select(weight)

f_list <- hare_weight_f$weight

# Create a vector for male weights, remove NAs
hare_weight_m <- hare_weight %>% 
  filter(sex == "Male", weight != "NA") %>% 
  select(weight)

m_list <- hare_weight_m$weight

```

```{r}
# Exploratory graphs for male and female hare weights
hist(f_list)

hist(m_list)

# Each distribution looks relatively normal
```

#### Run a t-test for male and female weights
```{r}

```







